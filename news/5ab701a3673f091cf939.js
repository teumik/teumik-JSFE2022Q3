(()=>{"use strict";var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Sw:()=>u,WC:()=>i});const t=class{baseLink;options;constructor(e,t){this.baseLink=e,this.options=t}getResp({endpoint:e,options:t={}},s=(()=>{console.error("No callback for GET response")})){this.load("GET",e,s,t)}errorHandler(e){if(!e.ok)throw 401!==e.status&&404!==e.status||console.log(`Sorry, but there is ${e.status}: ${i[e.status]} error: ${e.statusText}`),Error(e.statusText);return e}makeUrl(e,t){const s={...this.options,...e};let r=`${this.baseLink}${t}?`;return Object.keys(s).forEach((e=>{r+=`${e}=${s[e]}&`})),r.slice(0,-1)}load(e,t,s,r={}){fetch(this.makeUrl(r,t),{method:e}).then(this.errorHandler).then((e=>e.json())).then((e=>{s(e)})).catch((e=>console.error(e)))}},s=class extends t{constructor(){super("https://newsapi-redirect-production.up.railway.app/",{apiKey:"7f852e0142b94273a95d24da4bd5ccba"})}},r=class extends s{getSources(e,t=""){super.getResp({endpoint:"sources",options:{language:t}},e)}getNews(e,t){let{target:s}=e;const r=e.currentTarget;for(;s!==r;){if(s.classList.contains("source__item")){const e=s.getAttribute("data-source-id");return void(r.getAttribute("data-source")!==e&&(r.setAttribute("data-source",e),super.getResp({endpoint:"everything",options:{sources:e}},t)))}s=s.parentNode}}};class n{news;sources;constructor(){this.news=new class{draw(e){const t=e.length>=10?e.filter(((e,t)=>t<10)):e,s=document.createDocumentFragment(),r=document.querySelector("#newsItemTemp");t.forEach(((e,t)=>{const n=r.content.cloneNode(!0);t%2&&n.querySelector(".news__item").classList.add("alt"),n.querySelector(".news__meta-photo").style.backgroundImage=`url(${e.urlToImage||"img/news_placeholder.jpg"})`,n.querySelector(".news__meta-author").textContent=e.author||e.source.name,n.querySelector(".news__meta-date").textContent=e.publishedAt.slice(0,10).split("-").reverse().join("-"),n.querySelector(".news__description-title").textContent=e.title,n.querySelector(".news__description-source").textContent=e.source.name,n.querySelector(".news__description-content").textContent=e.description,n.querySelector(".news__read-more a").setAttribute("href",e.url),s.append(n)})),document.querySelector(".news").innerHTML="",document.querySelector(".news").appendChild(s)}},this.sources=new class{draw(e){const t=document.createDocumentFragment(),s=document.querySelector("#sourceItemTemp");e.forEach((e=>{const r=s.content.cloneNode(!0);r.querySelector(".source__item-name").textContent=e.name,r.querySelector(".source__item").setAttribute("data-source-id",e.id),t.append(r)}));const r=document.querySelector(".sources");r?r.replaceChildren(t):document.querySelector(".sources").append(t)}}}drawNews(e){const t=e?.articles?e?.articles:[];this.news.draw(t)}drawSources(e){const t=e?.sources?e?.sources:[];this.sources.draw(t)}}class o{static lang;container;constructor(){this.container=document.querySelector(".languages")}changeState(e){document.querySelector(".languages__items")?.classList.toggle("languages__items_visible");const{target:t}=e,{langId:s}=t.dataset;s&&(document.querySelectorAll(".languages__item").forEach((e=>e.classList.remove("languages__item_active"))),t.classList.add("languages__item_active"),o.lang=s)}drawMenuItems(e){if(e.sources){const t=document.createDocumentFragment();[...new Set(e.sources.map((e=>e.language)))].forEach((e=>{const s=document.createElement("div");s.dataset.langId=e,s.classList.add("languages__item"),s.innerHTML=u[e],t.append(s)}));const s=this.container.lastElementChild;s.children.length?s.replaceChildren(t):s.append(t)}}}const a=o;class c{input;source;button;constructor(){this.input=document.querySelector(".search__input"),this.source=document.getElementsByClassName("source__item"),this.button=document.querySelector(".search__button")}onInput(e){const{value:t}=e.target;Array.from(this.source).forEach((e=>{const s=e;s.hidden=!0,s.innerText.toLocaleUpperCase().trim().includes(t.trim().toLocaleUpperCase())&&(s.hidden=!1)}))}onReset(){this.input.value="",Array.from(this.source).forEach((e=>{e.hidden=!1}))}}var i,u;(new class{controller;view;lang;search;constructor(){this.controller=new r,this.view=new n,this.lang=new a,this.search=new c}start(){document.querySelector(".sources").addEventListener("click",(e=>this.controller.getNews(e,(e=>{this.view.drawNews(e)})))),this.controller.getSources((e=>{this.lang.drawMenuItems(e),this.view.drawSources(e)})),this.lang.container.addEventListener("click",(e=>{this.lang.changeState(e);const{target:t}=e,{langId:s}=t.dataset;s&&(this.search.onReset(),this.controller.getSources((e=>{this.view.drawSources(e)}),a.lang))})),document.addEventListener("click",(e=>{const{target:t}=e,s=t.closest(".languages");document.querySelector(".languages__items_visible")&&!s&&this.lang.changeState(e)})),globalThis.addEventListener("load",(()=>{this.lang.container.lastElementChild.hidden=!1})),this.search.input.addEventListener("input",(e=>{this.search.onInput(e)})),this.search.button.addEventListener("click",(()=>{this.search.onReset()}))}}).start(),function(e){e[e.Unauthorized=401]="Unauthorized",e[e["Not Found"]=404]="Not Found"}(i||(i={})),function(e){e.ar="Arabic",e.de="German",e.en="English",e.es="Spanish",e.fr="French",e.he="Hebrew",e.it="Italian",e.nl="Dutch",e.no="Norwegian",e.pt="Portuguese",e.ru="Russian",e.se="Northern Sami",e.sv="Swedish",e.ud="Urdu",e.zh="Chinese"}(u||(u={}))})();