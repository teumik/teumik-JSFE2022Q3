(()=>{"use strict";var t={d:(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{Z:()=>D});class e{constructor({tag:t,id:e,className:a,attributes:n,inner:i,childrens:s,click:r,submit:o,oninput:l}){this.node=this.render({tag:t,id:e,className:a,attributes:n,inner:i,childrens:s}),r&&(this.node.onclick=r),o&&(this.node.onsubmit=o),l&&(this.node.oninput=l)}render({tag:t,id:e,className:a,attributes:n,inner:i,childrens:s}){const r=document.createElement(t||"div");return e&&(r.id=e),a&&(Array.isArray(a)?r.classList.add(...a.filter((t=>""!==t))):r.classList.add(a)),n&&Object.entries(n).forEach((([t,e])=>{"boolean"==typeof e?e&&r.setAttribute(t,""):r.setAttribute(t,e)})),i&&(r.innerHTML=i),Array.isArray(s)?r.append(...s):r.append(s||""),r}}class a{constructor(t){this.node=null,this.parent=null,this.that=null,this.cb=t}render(t,a){var n,i,s,r;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const o=null===(n=this.that)||void 0===n?void 0:n.state.location,{node:l}=new e({tag:"nav",className:"nav",childrens:[new e({tag:"button",className:"nav__button",inner:"Garage",attributes:{disabled:"garage"===o},click:()=>this.cb("garage")}).node,new e({tag:"button",className:"nav__button",inner:"Winners",attributes:{disabled:(null===(i=this.that)||void 0===i?void 0:i.disabled.winners)||"winners"===o},click:()=>this.cb("winners")}).node]});return null===(s=this.node)||void 0===s||s.remove(),null===(r=this.parent)||void 0===r||r.append(l),this.node=l,l}}const n="http://127.0.0.1:3000",i="/garage",s="/winners",r="/engine",o=t=>Object.entries(t).map((t=>t.join("="))).join("&"),l=async(t=1)=>{const e=`?${o({_page:null!=t?t:1,_limit:7})}`,a=await fetch(`${n}${i}${null!==t?e:""}`);return await a.json()},d=async(t,{_sort:e,_order:a})=>{const i=`?${o({_page:null!=t?t:1,_limit:10})}`,r=`&${o({_sort:e,_order:a})}`,l=await fetch(`${n}${s}${null!==t?i:""}${void 0!==e?r:""}`);return await l.json()},u=async t=>{const{length:e}=await l(t);return e},h=t=>fetch(`${n}${i}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),c=async t=>{const e=await fetch(`${n}${i}/${t}`,{method:"GET"});return await e.json()},v=t=>Math.floor(Math.random()*t),p=async t=>{const e=o(t),a=await fetch(`${n}${r}?${e}`,{method:"PATCH"});if(null==a?void 0:a.ok){return await(null==a?void 0:a.json())}return{success:null==a?void 0:a.ok,code:null==a?void 0:a.status}};class g{constructor({childrens:t}){this.node=this.render({childrens:t})}render({childrens:t}){const e=document.createDocumentFragment();return Array.isArray(t)?e.append(...t):e.append(t||""),e}}class m{constructor(){this.onInput=(t,e)=>{var a,n;const{value:i}=t.target,s=null===(n=null===(a=this.that)||void 0===a?void 0:a.that)||void 0===n?void 0:n.state.creator;s&&Object.assign(s,{[e]:""!==i?i:null}),s&&this.updateViewState()},this.click=async t=>{var e,a,n,i,s,r,o,l,d,u,h,c,v,p,g,m;await this.submit(t),await(null===(a=null===(e=this.that)||void 0===e?void 0:e.that)||void 0===a?void 0:a.headers.render()),await(null===(i=null===(n=this.that)||void 0===n?void 0:n.that)||void 0===i?void 0:i.garage.render()),null===(r=null===(s=this.that)||void 0===s?void 0:s.that)||void 0===r||r.pageButtons.render();const b=null===(l=null===(o=this.that)||void 0===o?void 0:o.that)||void 0===l?void 0:l.state.creator;b&&Object.assign(b,{name:null,color:null,id:null}),this.updateViewState(),null===(u=null===(d=this.that)||void 0===d?void 0:d.that)||void 0===u||u.control.render(),await(null===(c=null===(h=this.that)||void 0===h?void 0:h.that)||void 0===c?void 0:c.headers.render()),await(null===(p=null===(v=this.that)||void 0===v?void 0:v.that)||void 0===p?void 0:p.garage.render()),null===(m=null===(g=this.that)||void 0===g?void 0:g.that)||void 0===m||m.pageButtons.render()},this.createLayout=(t,a)=>new g({childrens:[new e({tag:"input",className:"control__text",attributes:{type:"text",name:"name",value:t},oninput:t=>this.onInput(t,"name")}).node,new e({tag:"input",className:"control__color",attributes:{type:"color",name:"color",value:a},oninput:t=>this.onInput(t,"color")}).node,new e({tag:"button",className:"control__button",inner:"Create",click:this.click}).node]}).node,this.node=null,this.parent=null,this.that=null}async updateViewState(){var t,e;null===(t=this.that)||void 0===t||t.view.render(),null===(e=this.that)||void 0===e||e.panel.render()}async submit(t){t.preventDefault();const e=t.target.parentElement,a=new FormData(e),n={name:String(a.get("name")),color:String(a.get("color"))};e.color.value="#000000";e.children[0].value="",await h(n)}render(t,a){var n,i,s,r;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const o=null===(i=null===(n=this.that)||void 0===n?void 0:n.that)||void 0===i?void 0:i.state.creator,l=null==o?void 0:o.color,d=null==o?void 0:o.name,{node:u}=new e({tag:"form",className:["control__create","control__item"],childrens:[this.createLayout(d||"",l||"#000000")]});return null===(s=this.node)||void 0===s||s.remove(),null===(r=this.parent)||void 0===r||r.append(u),this.node=u,this.node}}const b=JSON.parse('[{"brand":"Seat","models":["Alhambra","Altea","Altea XL","Arosa","Cordoba","Cordoba Vario","Exeo","Ibiza","Ibiza ST","Exeo ST","Leon","Leon ST","Inca","Mii","Toledo"]},{"brand":"Renault","models":["Captur","Clio","Clio Grandtour","Espace","Express","Fluence","Grand Espace","Grand Modus","Grand Scenic","Kadjar","Kangoo","Kangoo Express","Koleos","Laguna","Laguna Grandtour","Latitude","Mascott","Mégane","Mégane CC","Mégane Combi","Mégane Grandtour","Mégane Coupé","Mégane Scénic","Scénic","Talisman","Talisman Grandtour","Thalia","Twingo","Wind","Zoé"]},{"brand":"Peugeot","models":["1007","107","106","108","2008","205","205 Cabrio","206","206 CC","206 SW","207","207 CC","207 SW","306","307","307 CC","307 SW","308","308 CC","308 SW","309","4007","4008","405","406","407","407 SW","5008","508","508 SW","605","806","607","807","Bipper","RCZ"]},{"brand":"Dacia","models":["Dokker","Duster","Lodgy","Logan","Logan MCV","Logan Van","Sandero","Solenza"]},{"brand":"Citroën","models":["Berlingo","C-Crosser","C-Elissée","C-Zero","C1","C2","C3","C3 Picasso","C4","C4 Aircross","C4 Cactus","C4 Coupé","C4 Grand Picasso","C4 Sedan","C5","C5 Break","C5 Tourer","C6","C8","DS3","DS4","DS5","Evasion","Jumper","Jumpy","Saxo","Nemo","Xantia","Xsara"]},{"brand":"Opel","models":["Agila","Ampera","Antara","Astra","Astra cabrio","Astra caravan","Astra coupé","Calibra","Campo","Cascada","Corsa","Frontera","Insignia","Insignia kombi","Kadett","Meriva","Mokka","Movano","Omega","Signum","Vectra","Vectra Caravan","Vivaro","Vivaro Kombi","Zafira"]},{"brand":"Alfa Romeo","models":["145","146","147","155","156","156 Sportwagon","159","159 Sportwagon","164","166","4C","Brera","GTV","MiTo","Crosswagon","Spider","GT","Giulietta","Giulia"]},{"brand":"Škoda","models":["Favorit","Felicia","Citigo","Fabia","Fabia Combi","Fabia Sedan","Felicia Combi","Octavia","Octavia Combi","Roomster","Yeti","Rapid","Rapid Spaceback","Superb","Superb Combi"]},{"brand":"Chevrolet","models":["Alero","Aveo","Camaro","Captiva","Corvette","Cruze","Cruze SW","Epica","Equinox","Evanda","HHR","Kalos","Lacetti","Lacetti SW","Lumina","Malibu","Matiz","Monte Carlo","Nubira","Orlando","Spark","Suburban","Tacuma","Tahoe","Trax"]},{"brand":"Porsche","models":["911 Carrera","911 Carrera Cabrio","911 Targa","911 Turbo","924","944","997","Boxster","Cayenne","Cayman","Macan","Panamera"]},{"brand":"Honda","models":["Accord","Accord Coupé","Accord Tourer","City","Civic","Civic Aerodeck","Civic Coupé","Civic Tourer","Civic Type R","CR-V","CR-X","CR-Z","FR-V","HR-V","Insight","Integra","Jazz","Legend","Prelude"]},{"brand":"Subaru","models":["BRZ","Forester","Impreza","Impreza Wagon","Justy","Legacy","Legacy Wagon","Legacy Outback","Levorg","Outback","SVX","Tribeca","Tribeca B9","XV"]},{"brand":"Mazda","models":["121","2","3","323","323 Combi","323 Coupé","323 F","5","6","6 Combi","626","626 Combi","B-Fighter","B2500","BT","CX-3","CX-5","CX-7","CX-9","Demio","MPV","MX-3","MX-5","MX-6","Premacy","RX-7","RX-8","Xedox 6"]},{"brand":"Mitsubishi","models":["3000 GT","ASX","Carisma","Colt","Colt CC","Eclipse","Fuso canter","Galant","Galant Combi","Grandis","L200","L200 Pick up","L200 Pick up Allrad","L300","Lancer","Lancer Combi","Lancer Evo","Lancer Sportback","Outlander","Pajero","Pajeto Pinin","Pajero Pinin Wagon","Pajero Sport","Pajero Wagon","Space Star"]},{"brand":"Lexus","models":["CT","GS","GS 300","GX","IS","IS 200","IS 250 C","IS-F","LS","LX","NX","RC F","RX","RX 300","RX 400h","RX 450h","SC 430"]},{"brand":"Toyota","models":["4-Runner","Auris","Avensis","Avensis Combi","Avensis Van Verso","Aygo","Camry","Carina","Celica","Corolla","Corolla Combi","Corolla sedan","Corolla Verso","FJ Cruiser","GT86","Hiace","Hiace Van","Highlander","Hilux","Land Cruiser","MR2","Paseo","Picnic","Prius","RAV4","Sequoia","Starlet","Supra","Tundra","Urban Cruiser","Verso","Yaris","Yaris Verso"]},{"brand":"BMW","models":["i3","i8","M3","M4","M5","M6","Rad 1","Rad 1 Cabrio","Rad 1 Coupé","Rad 2","Rad 2 Active Tourer","Rad 2 Coupé","Rad 2 Gran Tourer","Rad 3","Rad 3 Cabrio","Rad 3 Compact","Rad 3 Coupé","Rad 3 GT","Rad 3 Touring","Rad 4","Rad 4 Cabrio","Rad 4 Gran Coupé","Rad 5","Rad 5 GT","Rad 5 Touring","Rad 6","Rad 6 Cabrio","Rad 6 Coupé","Rad 6 Gran Coupé","Rad 7","Rad 8 Coupé","X1","X3","X4","X5","X6","Z3","Z3 Coupé","Z3 Roadster","Z4","Z4 Roadster"]},{"brand":"Volkswagen","models":["Amarok","Beetle","Bora","Bora Variant","Caddy","Caddy Van","Life","California","Caravelle","CC","Crafter","Crafter Van","Crafter Kombi","CrossTouran","Eos","Fox","Golf","Golf Cabrio","Golf Plus","Golf Sportvan","Golf Variant","Jetta","LT","Lupo","Multivan","New Beetle","New Beetle Cabrio","Passat","Passat Alltrack","Passat CC","Passat Variant","Passat Variant Van","Phaeton","Polo","Polo Van","Polo Variant","Scirocco","Sharan","T4","T4 Caravelle","T4 Multivan","T5","T5 Caravelle","T5 Multivan","T5 Transporter Shuttle","Tiguan","Touareg","Touran"]},{"brand":"Suzuki","models":["Alto","Baleno","Baleno kombi","Grand Vitara","Grand Vitara XL-7","Ignis","Jimny","Kizashi","Liana","Samurai","Splash","Swift","SX4","SX4 Sedan","Vitara","Wagon R+"]},{"brand":"Mercedes-Benz","models":["100 D","115","124","126","190","190 D","190 E","200 - 300","200 D","200 E","210 Van","210 kombi","310 Van","310 kombi","230 - 300 CE Coupé","260 - 560 SE","260 - 560 SEL","500 - 600 SEC Coupé","Trieda A","A","A L","AMG GT","Trieda B","Trieda C","C","C Sportcoupé","C T","Citan","CL","CL","CLA","CLC","CLK Cabrio","CLK Coupé","CLS","Trieda E","E","E Cabrio","E Coupé","E T","Trieda G","G Cabrio","GL","GLA","GLC","GLE","GLK","Trieda M","MB 100","Trieda R","Trieda S","S","S Coupé","SL","SLC","SLK","SLR","Sprinter"]},{"brand":"Saab","models":["9-3","9-3 Cabriolet","9-3 Coupé","9-3 SportCombi","9-5","9-5 SportCombi","900","900 C","900 C Turbo","9000"]},{"brand":"Audi","models":["100","100 Avant","80","80 Avant","80 Cabrio","90","A1","A2","A3","A3 Cabriolet","A3 Limuzina","A3 Sportback","A4","A4 Allroad","A4 Avant","A4 Cabriolet","A5","A5 Cabriolet","A5 Sportback","A6","A6 Allroad","A6 Avant","A7","A8","A8 Long","Q3","Q5","Q7","R8","RS4 Cabriolet","RS4/RS4 Avant","RS5","RS6 Avant","RS7","S3/S3 Sportback","S4 Cabriolet","S4/S4 Avant","S5/S5 Cabriolet","S6/RS6","S7","S8","SQ5","TT Coupé","TT Roadster","TTS"]},{"brand":"Kia","models":["Avella","Besta","Carens","Carnival","Cee`d","Cee`d SW","Cerato","K 2500","Magentis","Opirus","Optima","Picanto","Pregio","Pride","Pro Cee`d","Rio","Rio Combi","Rio sedan","Sephia","Shuma","Sorento","Soul","Sportage","Venga"]},{"brand":"Land Rover","models":["109","Defender","Discovery","Discovery Sport","Freelander","Range Rover","Range Rover Evoque","Range Rover Sport"]},{"brand":"Dodge","models":["Avenger","Caliber","Challenger","Charger","Grand Caravan","Journey","Magnum","Nitro","RAM","Stealth","Viper"]},{"brand":"Chrysler","models":["300 C","300 C Touring","300 M","Crossfire","Grand Voyager","LHS","Neon","Pacifica","Plymouth","PT Cruiser","Sebring","Sebring Convertible","Stratus","Stratus Cabrio","Town & Country","Voyager"]},{"brand":"Ford","models":["Aerostar","B-Max","C-Max","Cortina","Cougar","Edge","Escort","Escort Cabrio","Escort kombi","Explorer","F-150","F-250","Fiesta","Focus","Focus C-Max","Focus CC","Focus kombi","Fusion","Galaxy","Grand C-Max","Ka","Kuga","Maverick","Mondeo","Mondeo Combi","Mustang","Orion","Puma","Ranger","S-Max","Sierra","Street Ka","Tourneo Connect","Tourneo Custom","Transit","Transit","Transit Bus","Transit Connect LWB","Transit Courier","Transit Custom","Transit kombi","Transit Tourneo","Transit Valnik","Transit Van","Transit Van 350","Windstar"]},{"brand":"Hummer","models":["H2","H3"]},{"brand":"Hyundai","models":["Accent","Atos","Atos Prime","Coupé","Elantra","Galloper","Genesis","Getz","Grandeur","H 350","H1","H1 Bus","H1 Van","H200","i10","i20","i30","i30 CW","i40","i40 CW","ix20","ix35","ix55","Lantra","Matrix","Santa Fe","Sonata","Terracan","Trajet","Tucson","Veloster"]},{"brand":"Infiniti","models":["EX","FX","G","G Coupé","M","Q","QX"]},{"brand":"Jaguar","models":["Daimler","F-Pace","F-Type","S-Type","Sovereign","X-Type","X-type Estate","XE","XF","XJ","XJ12","XJ6","XJ8","XJ8","XJR","XK","XK8 Convertible","XKR","XKR Convertible"]},{"brand":"Jeep","models":["Cherokee","Commander","Compass","Grand Cherokee","Patriot","Renegade","Wrangler"]},{"brand":"Nissan","models":["100 NX","200 SX","350 Z","350 Z Roadster","370 Z","Almera","Almera Tino","Cabstar E - T","Cabstar TL2 Valnik","e-NV200","GT-R","Insterstar","Juke","King Cab","Leaf","Maxima","Maxima QX","Micra","Murano","Navara","Note","NP300 Pickup","NV200","NV400","Pathfinder","Patrol","Patrol GR","Pickup","Pixo","Primastar","Primastar Combi","Primera","Primera Combi","Pulsar","Qashqai","Serena","Sunny","Terrano","Tiida","Trade","Vanette Cargo","X-Trail"]},{"brand":"Volvo","models":["240","340","360","460","850","850 kombi","C30","C70","C70 Cabrio","C70 Coupé","S40","S60","S70","S80","S90","V40","V50","V60","V70","V90","XC60","XC70","XC90"]},{"brand":"Daewoo","models":["Espero","Kalos","Lacetti","Lanos","Leganza","Lublin","Matiz","Nexia","Nubira","Nubira kombi","Racer","Tacuma","Tico"]},{"brand":"Fiat","models":["1100","126","500","500L","500X","850","Barchetta","Brava","Cinquecento","Coupé","Croma","Doblo","Doblo Cargo","Doblo Cargo Combi","Ducato","Ducato Van","Ducato Kombi","Ducato Podvozok","Florino","Florino Combi","Freemont","Grande Punto","Idea","Linea","Marea","Marea Weekend","Multipla","Palio Weekend","Panda","Panda Van","Punto","Punto Cabriolet","Punto Evo","Punto Van","Qubo","Scudo","Scudo Van","Scudo Kombi","Sedici","Seicento","Stilo","Stilo Multiwagon","Strada","Talento","Tipo","Ulysse","Uno","X1/9"]},{"brand":"MINI","models":["Cooper","Cooper Cabrio","Cooper Clubman","Cooper D","Cooper D Clubman","Cooper S","Cooper S Cabrio","Cooper S Clubman","Countryman","Mini One","One D"]},{"brand":"Rover","models":["200","214","218","25","400","414","416","620","75"]},{"brand":"Smart","models":["Cabrio","City-Coupé","Compact Pulse","Forfour","Fortwo cabrio","Fortwo coupé","Roadster"]}]');class C{constructor(){this.reset=async()=>{var t,e,a,n,i,s,r,o,l,d,u,h,c,v,p,g;const m=null===(e=null===(t=this.that)||void 0===t?void 0:t.that)||void 0===e?void 0:e.garage.garage,b=null===(n=null===(a=this.that)||void 0===a?void 0:a.that)||void 0===n?void 0:n.garage.state;b&&Object.assign(b,Object.assign(Object.assign({},b),{isRace:!1})),null==m||m.map((t=>{var e;return null===(e=t.item.track)||void 0===e?void 0:e.click("b")})),this.disabled.race=!0;const C=null===(s=null===(i=this.that)||void 0===i?void 0:i.that)||void 0===s?void 0:s.control,w=null===(r=null==C?void 0:C.that)||void 0===r?void 0:r.state,S=structuredClone(this.state);w&&Object.assign(w,S),null==C||C.create.render(),null==C||C.update.render(),null==C||C.view.render(),await(null===(o=null==C?void 0:C.that)||void 0===o?void 0:o.garage.render()),this.disabled.race=!1;const y=null===(u=null===(d=null===(l=this.that)||void 0===l?void 0:l.that)||void 0===d?void 0:d.that)||void 0===u?void 0:u.disabled;y&&Object.assign(y,{winners:!1}),null===(c=null===(h=this.that)||void 0===h?void 0:h.that)||void 0===c||c.pageButtons.render(),null===(g=null===(p=null===(v=this.that)||void 0===v?void 0:v.that)||void 0===p?void 0:p.that)||void 0===g||g.nav.render(),this.render()},this.getRandomCar=()=>{const{length:t}=b,e=b[v(t)],{brand:a}=e,{models:n}=e,{length:i}=n;return{name:`${a} ${n[v(i)]}`,color:`#${Math.floor(16777215*Math.random()).toString(16).padStart(6,"0")}`}},this.generate=async()=>{var t;const e=Array(100).fill(null).map(this.getRandomCar),a=await(async t=>t.map((async t=>{await h(t)})))(e);await Promise.all(a);const n=null===(t=this.that)||void 0===t?void 0:t.that;await(null==n?void 0:n.headers.render()),await(null==n?void 0:n.garage.render()),null==n||n.pageButtons.render()},this.startRace=async()=>{var t,e,a,n;const i=null===(e=null===(t=this.that)||void 0===t?void 0:t.that)||void 0===e?void 0:e.garage.garage,s=null===(n=null===(a=this.that)||void 0===a?void 0:a.that)||void 0===n?void 0:n.garage.state;s&&Object.assign(s,Object.assign(Object.assign({},s),{isRace:!0})),null==i||i.map((t=>{var e;return null===(e=t.item.track)||void 0===e?void 0:e.click("a")})),this.disabled.race=!0},this.createLayout=()=>{var t,a,n;const i=null===(n=null===(a=null===(t=this.that)||void 0===t?void 0:t.that)||void 0===a?void 0:a.that)||void 0===n?void 0:n.disabled.winners,{node:s}=new e({tag:"div",className:["control__panel","control__item"],childrens:[new e({tag:"button",className:"cotrol__race",inner:"Race",attributes:{disabled:this.disabled.race||this.disabled.reset||!1},click:this.startRace}).node,new e({tag:"button",className:"cotrol__reset",inner:"Reset",attributes:{},click:this.reset}).node,new e({tag:"button",className:"cotrol__generate",inner:"Generate",attributes:{disabled:i||this.disabled.reset||!1},click:this.generate}).node]});return s},this.node=null,this.parent=null,this.that=null,this.state={id:null,updator:{name:null,color:null},creator:{name:null,color:null}},this.disabled={reset:!1,race:!1}}render(t,e){var a,n;this.parent=null!=t?t:this.parent,this.that=null!=e?e:this.that;const i=this.createLayout();return null===(a=this.node)||void 0===a||a.remove(),null===(n=this.parent)||void 0===n||n.append(i),this.node=i,this.node}}class w{constructor(){this.onInput=(t,e)=>{var a,n;const{value:i}=t.target,s=null===(n=null===(a=this.that)||void 0===a?void 0:a.that)||void 0===n?void 0:n.state.updator;s&&Object.assign(s,{[e]:""!==i?i:null}),s&&this.updateViewState()},this.createLayout=(t,a,n)=>new g({childrens:[new e({tag:"input",className:"control__text",attributes:{type:"text",name:"name",value:t,disabled:Boolean(!(null==n?void 0:n.id))},oninput:t=>this.onInput(t,"name")}).node,new e({tag:"input",className:"control__color",attributes:{type:"color",name:"color",value:a,disabled:Boolean(!(null==n?void 0:n.id))},oninput:t=>this.onInput(t,"color")}).node,new e({tag:"button",className:"control__button",inner:"Update",attributes:{disabled:Boolean(!(null==n?void 0:n.id))},click:async t=>this.click(t)}).node]}).node,this.node=null,this.parent=null,this.that=null,this.default={id:null,updator:{name:null,color:null,id:null},creator:{name:null,color:null,id:null}}}async submit(t,e){t.preventDefault();const a=t.target.parentElement,s=new FormData(a),r={},o=String(s.get("name")),l=String(s.get("color"));""!==o&&Object.assign(r,{name:o}),Object.assign(r,{color:l}),a.color.value="#000000";a.children[0].value="",await((t,e)=>fetch(`${n}${i}/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(e,r)}async click(t){var e,a,n,i,s,r,o,l,d,u,h,c;const v=null===(a=null===(e=this.that)||void 0===e?void 0:e.that)||void 0===a?void 0:a.state.id,p=t.target.parentElement;if(!v){const e=p.children[0];e.placeholder="Choose a car",e.value="Choose a car",e.style.color="orangered";const a=setInterval((()=>{var t,n;const i=null===(n=null===(t=this.that)||void 0===t?void 0:t.that)||void 0===n?void 0:n.state;(null==i?void 0:i.id)&&(e.placeholder="",e.value="",e.style.color="",clearInterval(a))}),500);return void t.preventDefault()}const g=null===(i=null===(n=this.that)||void 0===n?void 0:n.that)||void 0===i?void 0:i.state,m=structuredClone(this.default);g&&(Object.assign(g,m),g.id&&(g.id=null),await this.submit(t,v),null===(r=null===(s=this.that)||void 0===s?void 0:s.that)||void 0===r||r.control.render(),await(null===(l=null===(o=this.that)||void 0===o?void 0:o.that)||void 0===l?void 0:l.headers.render()),await(null===(u=null===(d=this.that)||void 0===d?void 0:d.that)||void 0===u?void 0:u.garage.render()),null===(c=null===(h=this.that)||void 0===h?void 0:h.that)||void 0===c||c.pageButtons.render(),this.updateViewState())}async updateViewState(){var t,e;null===(t=this.that)||void 0===t||t.view.render(),null===(e=this.that)||void 0===e||e.panel.render()}render(t,a){var n,i,s,r,o,l;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const d=null===(i=null===(n=this.that)||void 0===n?void 0:n.that)||void 0===i?void 0:i.state,u=null===(s=null==d?void 0:d.updator)||void 0===s?void 0:s.color,h=null===(r=null==d?void 0:d.updator)||void 0===r?void 0:r.name,{node:c}=new e({tag:"form",className:["control__update","control__item"],childrens:[this.createLayout(h||"",u||"#000000",d)]});return null===(o=this.node)||void 0===o||o.remove(),null===(l=this.parent)||void 0===l||l.append(c),this.node=c,this.node}}const S='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1000" height="1000" viewBox="0 0 1000 1000" xml:space="preserve">\n<rect x="0" y="0" width="100%" height="100%" fill="transparent"/>\n<g transform="matrix(-7.3982 0 0 7.3982 499.9999 500)" id="168053">\n<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; is-custom-font: none; font-file-url: none; fill-rule: evenodd; opacity: 1;" vector-effect="non-scaling-stroke" transform=" translate(-61.44, -17.5168)" d="M 99.42 13.57 c 5.93 0 10.73 4.8 10.73 10.73 c 0 5.93 -4.8 10.73 -10.73 10.73 s -10.73 -4.8 -10.73 -10.73 C 88.69 18.37 93.49 13.57 99.42 13.57 L 99.42 13.57 z M 79.05 5 c -0.59 1.27 -1.06 2.69 -1.42 4.23 c -0.82 2.57 0.39 3.11 3.19 2.06 c 2.06 -1.23 4.12 -2.47 6.18 -3.7 c 1.05 -0.74 1.55 -1.47 1.38 -2.19 c -0.34 -1.42 -3.08 -2.16 -5.33 -2.6 C 80.19 2.23 80.39 2.11 79.05 5 L 79.05 5 z M 23.86 19.31 c 2.75 0 4.99 2.23 4.99 4.99 c 0 2.75 -2.23 4.99 -4.99 4.99 c -2.75 0 -4.99 -2.23 -4.99 -4.99 C 18.87 21.54 21.1 19.31 23.86 19.31 L 23.86 19.31 z M 99.42 19.31 c 2.75 0 4.99 2.23 4.99 4.99 c 0 2.75 -2.23 4.99 -4.99 4.99 c -2.75 0 -4.99 -2.23 -4.99 -4.99 C 94.43 21.54 96.66 19.31 99.42 19.31 L 99.42 19.31 z M 46.14 12.5 c 2.77 -2.97 5.97 -4.9 9.67 -6.76 c 8.1 -4.08 13.06 -3.58 21.66 -3.58 l -2.89 7.5 c -1.21 1.6 -2.58 2.73 -4.66 2.84 H 46.14 L 46.14 12.5 z M 23.86 13.57 c 5.93 0 10.73 4.8 10.73 10.73 c 0 5.93 -4.8 10.73 -10.73 10.73 s -10.73 -4.8 -10.73 -10.73 C 13.13 18.37 17.93 13.57 23.86 13.57 L 23.86 13.57 z M 40.82 10.3 c 3.52 -2.19 7.35 -4.15 11.59 -5.82 c 12.91 -5.09 22.78 -6 36.32 -1.9 c 4.08 1.55 8.16 3.1 12.24 4.06 c 4.03 0.96 21.48 1.88 21.91 4.81 l -4.31 5.15 c 1.57 1.36 2.85 3.03 3.32 5.64 c -0.13 1.61 -0.57 2.96 -1.33 4.04 c -1.29 1.85 -5.07 3.76 -7.11 2.67 c -0.65 -0.35 -1.02 -1.05 -1.01 -2.24 c 0.06 -23.9 -28.79 -21.18 -26.62 2.82 H 35.48 C 44.8 5.49 5.04 5.4 12.1 28.7 C 9.62 31.38 3.77 27.34 0 18.75 c 1.03 -1.02 2.16 -1.99 3.42 -2.89 c -0.06 -0.05 0.06 0.19 -0.15 -0.17 c -0.21 -0.36 0.51 -1.87 1.99 -2.74 C 13.02 8.4 31.73 8.52 40.82 10.3 L 40.82 10.3 z" stroke-linecap="round"/>\n</g>\n</svg>\n';class y{constructor(){this.node=null,this.parent=null,this.that=null}render(t,a){var n,i,s,r,o,l,d,u,h,c,v,p;const g=null===(i=null===(n=this.that)||void 0===n?void 0:n.that)||void 0===i?void 0:i.state,m=null!==(l=null!==(r=null===(s=null==g?void 0:g.updator)||void 0===s?void 0:s.name)&&void 0!==r?r:null===(o=null==g?void 0:g.creator)||void 0===o?void 0:o.name)&&void 0!==l?l:"",b=null!==(c=null!==(u=null===(d=null==g?void 0:g.updator)||void 0===d?void 0:d.color)&&void 0!==u?u:null===(h=null==g?void 0:g.creator)||void 0===h?void 0:h.color)&&void 0!==c?c:"#000000";this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const{node:C}=new e({className:["control__icon"],attributes:{style:`fill: ${b}`},inner:S}),{node:w}=new e({className:["control__name"],inner:m}),{node:y}=new e({className:"control__view",childrens:[C,w]});return null===(v=this.node)||void 0===v||v.remove(),null===(p=this.parent)||void 0===p||p.append(y),this.node=y,this.node}}class _{constructor(){this.node=null,this.create=new m,this.update=new w,this.view=new y,this.panel=new C,this.parent=null,this.that=null}render(t,a){var n,i;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const{node:s}=new e({tag:"section",className:"control"});return this.create.render(s,this),this.update.render(s,this),this.view.render(s,this),this.panel.render(s,this),null===(n=this.node)||void 0===n||n.remove(),null===(i=this.parent)||void 0===i||i.append(s),this.node=s,this.node}}class T{constructor(){this.node=null,this.parent=null,this.that=null,this.disabled={page:!1}}async swipePage(t){var e,a,n,i;const s=null===(e=this.that)||void 0===e?void 0:e.pageNumber;switch(t){case"<":if(1===(null==s?void 0:s.current))return;s&&(s.current-=1);break;case">":if((null==s?void 0:s.max)===(null==s?void 0:s.current))return;s&&(s.current+=1)}await(null===(a=this.that)||void 0===a?void 0:a.headers.render()),await(null===(n=this.that)||void 0===n?void 0:n.garage.render()),null===(i=this.that)||void 0===i||i.pageButtons.render()}render(t,a){var n,i,s,r,o;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const l=null===(n=this.that)||void 0===n?void 0:n.pageNumber,d=null==l?void 0:l.max,u=null==l?void 0:l.current,h=null===(s=null===(i=this.that)||void 0===i?void 0:i.that)||void 0===s?void 0:s.disabled.winners,{node:c}=new e({className:"main__buttons",childrens:[new e({tag:"button",className:["main__buttons_prev"],inner:"Prev",attributes:{disabled:h||this.disabled.page||1===u},click:()=>this.swipePage("<")}).node,new e({tag:"button",className:["main__buttons_next"],inner:"Next",attributes:{disabled:h||0===d||this.disabled.page||u===d||null===d},click:()=>this.swipePage(">")}).node]});return null===(r=this.node)||void 0===r||r.remove(),null===(o=this.parent)||void 0===o||o.append(c),this.node=c,c}}class k{constructor(){this.select=async t=>{var e,a;const n=null===(a=null===(e=this.that)||void 0===e?void 0:e.that)||void 0===a?void 0:a.that;if(t&&(Object.assign(t,{id:this.id}),this.id)){const e=await c(this.id),{updator:a}=t;a&&Object.assign(a,e),null==n||n.control.create.render(),null==n||n.control.update.render(),null==n||n.control.view.render(),null==n||n.control.panel.render(),await(null==n?void 0:n.garage.render()),null==n||n.pageButtons.render()}},this.remove=async()=>{var t,e;const a=null===(e=null===(t=this.that)||void 0===t?void 0:t.that)||void 0===e?void 0:e.that;if(!this.id)return;var r;await(r=this.id,fetch(`${n}${i}/${r}`,{method:"DELETE"})),await(t=>fetch(`${n}${s}/${t}`,{method:"DELETE"}))(this.id),await(null==a?void 0:a.headers.render()),await(null==a?void 0:a.garage.render()),null==a||a.pageButtons.render();const o=null==a?void 0:a.state,l=structuredClone(this.default);o&&Object.assign(o,l),null==a||a.control.update.render(),null==a||a.control.view.render(),null==a||a.control.panel.render()},this.node=null,this.that=null,this.id=null,this.default={id:null,updator:{name:null,color:null,id:null},creator:{name:null,color:null,id:null}}}render(t,a,n){var i,s,r;this.that=null!=n?n:this.that,this.id=null===(i=this.that)||void 0===i?void 0:i.state.car.id;const o=null===(r=null===(s=this.that.that)||void 0===s?void 0:s.that)||void 0===r?void 0:r.state,{node:l}=new e({className:"car__control",childrens:[new e({tag:"button",className:"car__select",inner:"Select",attributes:{disabled:(null==o?void 0:o.id)===this.id},click:async()=>this.select(o)}).node,new e({tag:"button",className:"car__remove",inner:"Remove",click:this.remove}).node,new e({tag:"span",className:"car__name",inner:t}).node]});return a.append(l),this.node=l,this.node}}class L{constructor(){this.node=null,this.color=null,this.car=null}upadteIcon(t){var a,n;const{node:i}=new e({tag:"span",className:["car__car-icon"],attributes:{style:`fill: ${this.color}; transform: translate(${t}px, -50%)`},inner:S});null===(a=this.car)||void 0===a||a.remove(),null===(n=this.node)||void 0===n||n.prepend(i),this.car=i}render(t,a){this.color=t;const{node:n}=new e({tag:"span",className:["car__car-icon"],attributes:{style:`fill: ${t}`},inner:S});this.car=n;const{node:i}=new e({tag:"span",className:["car__flag-icon"],attributes:{style:`fill: ${t}`},inner:'<?xml version="1.0" encoding="iso-8859-1"?>\r\n\x3c!-- Generator: Adobe Illustrator 18.1.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\r\n<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\r\n\t viewBox="0 0 612.001 612.001" style="enable-background:new 0 0 612.001 612.001;" xml:space="preserve">\r\n<path d="M609.247,314.664l-148.93-148.928c-3.672-3.671-9.627-3.672-13.299,0.001L306.001,306.753L164.984,165.737\r\n\tc-3.673-3.672-9.627-3.673-13.299-0.001L2.755,314.664C0.991,316.429,0,318.821,0,321.315c0,2.494,0.991,4.886,2.755,6.651\r\n\tl118.298,118.298c1.764,1.765,4.155,2.755,6.65,2.755c2.494,0,4.886-0.991,6.649-2.755l142.279-142.279l16.07,16.07l-96.84,96.84\r\n\tc-3.673,3.673-3.673,9.627,0,13.3c1.836,1.836,4.243,2.753,6.649,2.753c2.406,0,4.814-0.919,6.65-2.753l96.842-96.842l96.842,96.842\r\n\tc1.836,1.836,4.244,2.753,6.65,2.753s4.814-0.919,6.65-2.753c3.673-3.673,3.673-9.627,0-13.3l-96.84-96.84l16.07-16.07\r\n\tL477.65,446.264c1.764,1.765,4.155,2.755,6.65,2.755c2.494,0,4.886-0.991,6.65-2.755l118.298-118.298\r\n\tc1.764-1.765,2.755-4.157,2.755-6.651C612.001,318.821,611.009,316.429,609.247,314.664z M233.542,320.475l-32.785-32.783\r\n\tl-37.497,37.495l32.785,32.785l-37.495,37.497l-32.785-32.785L94.919,393.53L55.491,354.1l30.842-30.842l39.427,39.427\r\n\tl37.496-37.496l-39.429-39.429l-37.493,37.493l-32.783-32.783l37.497-37.495l32.785,32.785l37.497-37.497l-32.785-32.785\r\n\tl29.79-29.79l32.785,32.785l-29.79,29.79l39.43,39.43l29.79-29.791l32.785,32.785L233.542,320.475z M556.514,354.1l-39.428,39.43\r\n\tl-30.846-30.846l-32.785,32.785l-37.495-37.497l32.785-32.785l-37.497-37.495l-32.785,32.783l-29.79-29.79l32.782-32.785\r\n\tl29.79,29.791l39.43-39.43l-29.79-29.79l32.785-32.785l29.79,29.79l-32.785,32.785l37.496,37.496l-39.424,39.424l37.495,37.495\r\n\tl39.429-39.429l-37.495-37.495l32.78-32.78l37.497,37.495l-32.785,32.785L556.514,354.1z"/>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n<g>\r\n</g>\r\n</svg>\r\n'}),{node:s}=new e({className:["car__images"],childrens:[n,i]});return null==a||a.append(s),this.node=s,this.node}}class N{constructor(t){this.node=null,this.parent=null,this.that=null,this.click=t}render(t,a){var n,i,s;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const r=null===(n=this.that)||void 0===n?void 0:n.state,{node:o}=new e({className:["car__options"],childrens:[new e({tag:"button",className:["car__buttons","car__buttons_start"],inner:"A",attributes:{disabled:(null==r?void 0:r.startDisabled)||(null==r?void 0:r.engine)||!1,id:"a"},click:()=>this.click("a")}).node,new e({tag:"button",className:["car__buttons","car__buttons_pause"],inner:"B",attributes:{disabled:(null==r?void 0:r.stopDisabled)||!(null==r?void 0:r.engine)||!1,id:"b"},click:()=>this.click("b")}).node]});return null===(i=this.node)||void 0===i||i.remove(),null===(s=this.parent)||void 0===s||s.append(o),this.node=o,o}}class R{constructor({ctx:t,svg:e}){this.init=({velocity:t,distance:e})=>{var a;this.settings.duration=e/t,this.car.parentElement&&(this.settings.distance=Number(null===(a=this.car.parentElement)||void 0===a?void 0:a.offsetWidth)-this.car.offsetWidth)},this.reset=()=>{this.car.style.transform="translate(0px, -50%)",this.startTime=null},this.stop=()=>{this.state.state.animeId&&(this.state.state.animeId.map((t=>cancelAnimationFrame(t))),this.state.state.animeId=[])},this.animate=t=>{this.startTime||(this.startTime=t);const e=t-this.startTime,a=e/this.settings.duration,n=this.settings.distance*Math.min(a,1);this.car.style.transform=`translate(${n}px, -50%)`,e<this.settings.duration&&this.state.state.animeId.push(requestAnimationFrame(this.animate))},this.start=()=>{this.state.state.animeId.push(requestAnimationFrame(this.animate))},this.settings={distance:0,duration:0},this.state=t,this.car=e,this.startTime=null}}class f{constructor(){this.setWinnerStat=async({id:t,time:e})=>{var a,i;const r=null===(i=null===(a=this.that)||void 0===a?void 0:a.that)||void 0===i?void 0:i.state.winners;if(!r)return;if(null==r?void 0:r.has(t)){const a=r.get(t);if(!a)return;const n=a.wins+1,i=Math.min(a.time,e);null==r||r.set(t,{id:t,wins:n,time:i})}else null==r||r.set(t,{id:t,wins:1,time:Math.round(100*e)/100});const o=null!==(await(async t=>{const e=await fetch(`${n}${s}/${t}`,{method:"GET"}),{status:a}=e;return 404===a?{id:null}:await e.json()})(t)).id,l=r.get(t);l&&(o?await(({id:t,time:e,wins:a})=>fetch(`${n}${s}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({wins:a,time:e})}))(l):await(t=>fetch(`${n}${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}))(l))},this.showWinner=t=>{var a;const n=null===(a=this.that)||void 0===a?void 0:a.state.car,{node:i}=new e({className:["winner"],inner:`Winner is car #${null==n?void 0:n.id} ${null==n?void 0:n.name} (${t}s)`}),{node:s}=new e({className:["overlay"],click:()=>{s.remove()}});s.append(i),D.append(s)},this.updateRender=({link:t,navLink:e,pageLink:a})=>{null==t||t.render(),null==e||e.render(),null==a||a.render()},this.removeDisabled=({navDisabled:t,disabled:e,pageDisabled:a,garage:n})=>{t&&e&&a&&0===(null==n?void 0:n.racers.length)&&(Object.assign(e,{reset:!1}),Object.assign(a,{page:!1}),Object.assign(n,Object.assign(Object.assign({},n),{isRace:!1,winner:null})))},this.stopClick=async({id:t,status:e})=>{this.animation&&(await p({id:t,status:e}),this.animation.stop(),this.animation.reset(),this.state.engine=!1,this.state.pause=!0)},this.startClick=({navDisabled:t,disabled:e,pageDisabled:a,garage:n,link:i,navLink:s,pageLink:r})=>{var o;t&&e&&a&&!e.reset&&(Object.assign(e,{reset:!0}),Object.assign(t,{winners:!0}),Object.assign(a,{page:!0}),this.updateRender({link:i,navLink:s,pageLink:r})),this.state.engine=!0,this.state.pause=!1,this.state.stopDisabled=!0,this.state.id&&(null===(o=null==n?void 0:n.racers)||void 0===o||o.push(this.state.id))},this.afterLastFinish=({garage:t,success:e,carParams:a})=>{const{id:n}=this.state;if(n&&e&&!this.state.pause&&(null==t?void 0:t.isRace)&&t&&null===t.winner){Object.assign(t,Object.assign(Object.assign({},t),{winner:n}));const{velocity:e,distance:i}=a,s=Math.round(i/e/1e3*100)/100;this.showWinner(s),this.setWinnerStat({id:n,time:s})}},this.startDisable=t=>{var e;this.state.startDisabled=t,null===(e=this.engineButtons)||void 0===e||e.render()},this.stopDisable=t=>{var e;this.state.stopDisabled=t,null===(e=this.engineButtons)||void 0===e||e.render()},this.toggleEngineState=()=>{var t;this.state.engine=!this.state.engine,null===(t=this.engineButtons)||void 0===t||t.render()},this.click=async t=>{var e,a,n,i,s,r,o,l,d,u,h,c,v,g,m,b;this.toggleEngineState();const C=null===(i=null===(n=null===(a=null===(e=this.that)||void 0===e?void 0:e.that)||void 0===a?void 0:a.that)||void 0===n?void 0:n.control)||void 0===i?void 0:i.panel,w=null==C?void 0:C.disabled,S=null===(l=null===(o=null===(r=null===(s=this.that)||void 0===s?void 0:s.that)||void 0===r?void 0:r.that)||void 0===o?void 0:o.that)||void 0===l?void 0:l.nav,y=null===(d=null==S?void 0:S.that)||void 0===d?void 0:d.disabled,_=null===(c=null===(h=null===(u=this.that)||void 0===u?void 0:u.that)||void 0===h?void 0:h.that)||void 0===c?void 0:c.pageButtons,T=null==_?void 0:_.disabled,k=null===(g=null===(v=this.that)||void 0===v?void 0:v.that)||void 0===g?void 0:g.state,L=null!==(m=this.state.id)&&void 0!==m?m:null===(b=this.that)||void 0===b?void 0:b.state.car.id;if(!L)return;this.state.id=L;const N={a:"started",b:"stopped"}[t];if(!this.animation)return;if("started"===N&&this.startClick({navDisabled:y,disabled:w,pageDisabled:T,garage:k,link:C,navLink:S,pageLink:_}),"stopped"===N)return void await this.stopClick({id:L,status:N});this.animation.stop(),this.animation.reset(),this.startDisable(!0);const R=await p({id:L,status:N});if(this.stopDisable(!1),this.state.pause)return;this.animation.init(R),this.animation.start();const{success:f,code:P}=await p({id:L,status:"drive"});k&&this.afterLastFinish({garage:k,success:f,carParams:R}),this.startDisable(!1),(null==k?void 0:k.racers)&&((t,e)=>{const a=t.findIndex((t=>t===e));-1!==a&&t.splice(a,1)})(k.racers,L),this.removeDisabled({navDisabled:y,disabled:w,pageDisabled:T,garage:k}),this.updateRender({link:C,navLink:S,pageLink:_}),(f||500===P)&&this.animation.stop()},this.node=null,this.that=null,this.carIcons=new L,this.engineButtons=null,this.animation=null,this.svg=null,this.state={startDisabled:!1,stopDisabled:!1,id:null,engine:!1,animeId:[],pause:!1}}render(t,a,n){this.that=null!=n?n:this.that;const{node:i}=new e({}),s=this.carIcons.render(t),{node:r}=new e({className:"car__track",childrens:[i,s]});return this.svg=s.querySelector(".car__car-icon"),this.animation=new R({ctx:this,svg:this.svg}),this.engineButtons=new N(this.click),this.engineButtons.render(i,this),a.append(r),this.node=r,this.node}}class P{constructor(){this.Control=k,this.Track=f,this.track=null,this.node=null,this.that=null,this.state={car:{id:null,name:null,color:null}}}render({name:t,color:a,id:n},i,s){this.that=null!=s?s:this.that,this.state.car={name:t,color:a,id:n};const{node:r}=new e({tag:"article",className:["garage__cars"]});return(new this.Control).render(t,r,this),this.track=new this.Track,this.track.render(a,r,this),i.append(r),this.node=r,this.node}}class A{constructor(){this.initWinners=async()=>{(await d(null,{})).map((t=>this.state.winners.set(t.id,t)))},this.node=null,this.that=null,this.parent=null,this.GarageCar=P,this.garage=null,this.state={racers:[],winner:null,winners:new Map,isRace:!1}}async getGarageList(){var t;const e=null===(t=this.that)||void 0===t?void 0:t.pageNumber.current;return await l(e)}async render(t,a){var n,i;await this.initWinners(),this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const s=await this.getGarageList(),r=await u(),{node:o}=new e({tag:"section",className:"garage",childrens:[r?"":new e({inner:"Garage empty"}).node]});return this.garage=s.map((t=>({car:t,item:new this.GarageCar}))),this.garage.map((({item:t,car:e})=>t.render(e,o,this))),null===(n=this.node)||void 0===n||n.remove(),null===(i=this.parent)||void 0===i||i.append(o),this.node=o,this.node}}class M{constructor(){this.creatLayout=({length:t,current:a})=>{const{node:n}=new e({childrens:[new e({tag:"h2",className:"title",inner:"Garage ",childrens:[new e({tag:"span",className:"title__cars-count",inner:`(${t})`}).node]}).node,new e({tag:"h3",className:"subtitle",inner:"Page #",childrens:[new e({tag:"span",className:"subtitle__pages-count",inner:`${a}`}).node]}).node]});return n},this.node=null,this.that=null,this.parent=null}async render(t,e){var a,n,i;this.parent=null!=t?t:this.parent,this.that=null!=e?e:this.that;const s=await u(null),r=Math.ceil(s/7),o=null===(a=this.that)||void 0===a?void 0:a.pageNumber;o&&Object.assign(o,Object.assign(Object.assign({},o),{max:r}));const l=(null==o?void 0:o.current)||1,d=this.creatLayout({length:s,current:l});return null===(n=this.node)||void 0===n||n.remove(),null===(i=this.parent)||void 0===i||i.append(d),this.node=d,d}}class x{constructor(){this.node=null,this.that=null,this.parent=null,this.control=new _,this.headers=new M,this.garage=new A,this.pageButtons=new T,this.state={id:null,updator:{name:null,color:null},creator:{name:null,color:null}},this.pageNumber={current:1,max:null}}async render(t,a){var n;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const{node:i}=new e({tag:"main",className:"main"});return this.control.render(i,this),await this.headers.render(i,this),await this.garage.render(i,this),this.pageButtons.render(i,this),null===(n=this.parent)||void 0===n||n.append(i),this.node=i,this.node}}class V{constructor(){this.creatLayout=({length:t,current:a})=>{const{node:n}=new e({childrens:[new e({tag:"h2",className:"title",inner:"Winners ",childrens:[new e({tag:"span",className:"title__winners-count",inner:`(${t})`}).node]}).node,new e({tag:"h3",className:"subtitle",inner:"Page #",childrens:[new e({tag:"span",className:"subtitle__pages-count",inner:`${a}`}).node]}).node]});return n},this.node=null,this.that=null,this.parent=null}async render(t,e){var a,n,i;this.parent=null!=t?t:this.parent,this.that=null!=e?e:this.that;const s=await(async t=>{const{length:e}=await d(t,{});return e})(null),r=Math.ceil(s/10),o=null===(a=this.that)||void 0===a?void 0:a.pageNumber;o&&Object.assign(o,Object.assign(Object.assign({},o),{max:r}));const l=(null==o?void 0:o.current)||1,u=this.creatLayout({length:s,current:l});return null===(n=this.node)||void 0===n||n.remove(),null===(i=this.parent)||void 0===i||i.append(u),this.node=u,u}}class G{constructor(){this.node=null,this.parent=null,this.that=null}async swipePage(t){var e,a,n,i;const s=null===(e=this.that)||void 0===e?void 0:e.pageNumber;switch(t){case"<":if(1===(null==s?void 0:s.current))return;s&&(s.current-=1);break;case">":if((null==s?void 0:s.max)===(null==s?void 0:s.current))return;s&&(s.current+=1)}await(null===(a=this.that)||void 0===a?void 0:a.headers.render()),await(null===(n=this.that)||void 0===n?void 0:n.table.rows.render()),null===(i=this.that)||void 0===i||i.pageButtons.render()}render(t,a){var n,i,s,r,o;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const l=null===(n=this.that)||void 0===n?void 0:n.pageNumber,d=null==l?void 0:l.max,u=null==l?void 0:l.current,h=null===(s=null===(i=this.that)||void 0===i?void 0:i.that)||void 0===s?void 0:s.disabled.winners,{node:c}=new e({className:"main__buttons",childrens:[new e({tag:"button",className:["main__buttons_prev"],inner:"Prev",attributes:{disabled:h||1===(null==l?void 0:l.current)},click:()=>this.swipePage("<")}).node,new e({tag:"button",className:["main__buttons_next"],inner:"Next",attributes:{disabled:h||0===d||u===d||null===d},click:()=>this.swipePage(">")}).node]});return null===(r=this.node)||void 0===r||r.remove(),null===(o=this.parent)||void 0===o||o.append(c),this.node=c,c}}class O{constructor(){this.getRowCell=async({wins:t,time:a,id:n})=>{const{name:i,color:s}=await c(n);return new g({childrens:[new e({tag:"td",className:["table__column"],attributes:{style:`fill: ${s}`},inner:`${S}`}).node,new e({tag:"td",className:["table__column"],inner:`${i}`}).node,new e({tag:"td",className:["table__column"],inner:`${t}`}).node,new e({tag:"td",className:["table__column"],inner:`${a}`}).node]}).node},this.node=null,this.that=null,this.parent=null}async getRowElements(){var t,a,n;const i=null===(a=null===(t=this.that)||void 0===t?void 0:t.that)||void 0===a?void 0:a.pageNumber.current,s=null===(n=this.that)||void 0===n?void 0:n.state;return(await d(i||null,{_sort:(null==s?void 0:s.name)||"",_order:(null==s?void 0:s.wins)||(null==s?void 0:s.time)?"asc":"desc"})).map((async({wins:t,time:a,id:n},s)=>{const r=s+10*((i||1)-1)+1,{node:o}=new e({tag:"tr",className:"table__row",childrens:[new e({tag:"td",className:"table__column",inner:`${r}`}).node]}),l=await this.getRowCell({wins:t,time:a,id:n});return o.append(l),o}))}async render(t,a){var n,i;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const{node:s}=new e({tag:"tbody",className:"table__body"}),r=await Promise.all(await this.getRowElements());return s.append(...r),null===(n=this.node)||void 0===n||n.remove(),null===(i=this.parent)||void 0===i||i.append(s),this.node=s,s}}class j{constructor(t,e){this.click=()=>{var t,e,a,n;const i=null===(t=this.that)||void 0===t?void 0:t.state;if(!i)return;const{id:s,name:r}=this.state;if(s<3)return;i.sort=!0;Object.assign(i,Object.assign(Object.assign(Object.assign({},i),{wins:null,time:null}),{name:r,[r]:!i[r]})),null===(a=null===(e=this.that)||void 0===e?void 0:e.heads)||void 0===a||a.map((t=>t.render())),null===(n=this.that)||void 0===n||n.rows.render()},this.name=e,this.node=null,this.that=null,this.parent=null,this.state={id:t,name:e.toLocaleLowerCase(),sortClass:null}}render(t,a){var n,i,s,r;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const o=null===(n=this.that)||void 0===n?void 0:n.state,l=null===(i=this.that)||void 0===i?void 0:i.state.sort,{id:d,name:u}=this.state;l&&o&&d>=3&&(this.state.sortClass="table__headers",null!==o[u]&&(this.state.sortClass=o[u]?`${this.state.sortClass}_asc`:`${this.state.sortClass}_desc`));const{node:h}=new e({tag:"th",className:["table__headers",this.state.sortClass||""],inner:this.name,attributes:{id:this.name.toLocaleLowerCase()},click:this.click});return null===(s=this.node)||void 0===s||s.remove(),null===(r=this.parent)||void 0===r||r.append(h),this.node=h,h}}class E{constructor(){this.headColumnNames=["Number","Car","Name","Wins","Time"],this.rows=new O,this.node=null,this.that=null,this.parent=null,this.body=null,this.heads=null,this.state={name:null,sort:!1,wins:null,time:null}}render(t,a){this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const{node:n}=new e({tag:"thead",className:"table__head"});this.heads=this.headColumnNames.map(((t,e)=>{const a=new j(e,t);return a.render(n,this),a}));const{node:i}=new e({tag:"table",className:"table"});return i.append(n),this.rows.render(i,this),null==t||t.append(i),this.node=i,i}}class ${constructor(){this.node=null,this.parent=null,this.pageButtons=new G,this.headers=new V,this.table=new E,this.that=null,this.pageNumber={current:1,max:null}}async render(t,a){var n;this.parent=null!=t?t:this.parent,this.that=null!=a?a:this.that;const{node:i}=new e({}),{node:s}=new e({tag:"main",className:"main",childrens:[i]});return await this.headers.render(i,this),this.table.render(s,this),this.pageButtons.render(s,this),null===(n=this.parent)||void 0===n||n.append(s),this.node=s,this.node}}const X=null===document||void 0===document?void 0:document.getElementById("root");(new class{constructor(){const t=this.click.bind(this);this.nav=new a(t),this.winnersPage=new $,this.garagePage=new x,this.node=null,this.state={location:"garage",currentPage:this.garagePage},this.parent=null,this.disabled={winners:!1}}click(t){const e={winners:this.winnersPage,garage:this.garagePage};this.state.currentPage=e[t],this.state.location=t,this.render(this.parent)}async render(t){var a;if(!await(async()=>{try{return await fetch(`${n}`),!0}catch(t){return!1}})())return new e({}).node;this.parent=null!=t?t:this.parent;const{node:i}=new e({}),{node:s}=new e({id:"App",childrens:[i]});return this.nav.render(i,this),this.state.currentPage.render(s,this),this.node=s,null===(a=this.parent)||void 0===a||a.replaceChildren(s),s}}).render(X);const D=X;console.log("\nПривет! Если обнаружишь проблемы, баги и расхождения с ТЗ, буду признателен, если ты напиши мне. В свою очередь я оперативно все исправлю!\n\nСвязаться можно через:\nTelegram @teumik\nDiscord teumik#1795\n")})();